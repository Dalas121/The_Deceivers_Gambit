#textdomain wesnoth-tdg
    
[scenario]
    id,map_file,name=10x_Revelry,10x_Revelry.map,_"Revelry"
    next_scenario,victory_when_enemies_defeated=11_The_Traitor,no
    theme=Cutscene_Minimal
    
    {DEFAULT_SCHEDULE_FIRST_WATCH} # same as S12
    {SCENARIO_MUSIC breaking_the_chains.ogg}
    
    
    
    
    
    #######################################################################################################################################################
    #                                                                   DEFINE SIDES
    #######################################################################################################################################################
    [side]
        side,controller,color=1,human,red
        id,defeat_condition,gold=Delfador,never,0
        team_name=wesnoth
    [/side]
    
    [side]
        side,controller,color=2,ai,wesred
        type,id,name,facing="Lieutenant",Moreth,_"Moreth",sw
        {MODIFICATIONS( {TRAIT_QUICK} {TRAIT_STRONG} )}
        hidden,gold,income=yes,yes,0,-2
        team_name=wesnoth
    [/side]
    {STARTING_VILLAGES_AREA 2 15 10 9}
    
    
    
    
    
    #######################################################################################################################################################
    #                                                                    PREPARE MAP
    #######################################################################################################################################################
    [event]
        name=prestart
        
        #############################
        # SCENERY
        #############################
        {PLACE_IMAGE terrain/castle/encampment/tent2.png  6 12} # these are "keeps"
        {PLACE_IMAGE terrain/castle/encampment/tent2.png 11 14}
        {PLACE_IMAGE items/gold-coins-large.png 14 10} # matching S12
        
        
        #############################
        # GUARDS
        #############################
        {GENERIC_UNIT 2 "Pikeman"  10  7} {FACING ne}
        {GENERIC_UNIT 2 "Spearman"  8  8} {FACING nw}
        {GENERIC_UNIT 2 "Pikeman"   8 11} {FACING nw}
        {GENERIC_UNIT 2 "Bowman"   10 11} {FACING ne}
        {GENERIC_UNIT 2 "Spearman" 11 12} {FACING se}
        
        {GENERIC_UNIT 2 "Swordsman" 23 12} {FACING se}
        
        {GENERIC_UNIT 2 "Horseman" 15 4} {FACING nw}
        {GENERIC_UNIT 2 "Horseman" 17 5} {FACING ne}
        {GENERIC_UNIT 2 "Knight"   19 5} {FACING ne}
        
        
        #############################
        # REVELERS
        #############################
        {GENERIC_UNIT 2 "Footpad" 13 6} {GENDER female} {FACING se}
        {RECALL_INFANTRYMAN 0 14 7 Fencer {FACING ne}} # this position is used to change side later
        {MODIFY_UNIT x,y=14,7 side 2}
        {GENERIC_UNIT 2 "Thief"   14 7} {GENDER male}   {FACING ne}
        {RECALL_COMPANION 15 7}
        {MODIFY_UNIT id=$companion_id facing nw}
        {MODIFY_UNIT id=$companion_id side 2}
        
        {GENERIC_UNIT 2 "Mage" 14 12} {GENDER female} {FACING ne}
        {GENERIC_UNIT 2 "Mage" 15 12} {GENDER male}   {FACING sw}
        
        
        #############################
        # UNITS
        #############################
        {RECALL_XY Delfador 22 8}
        {MODIFY_UNIT id=Delfador facing sw}
        [modify_unit]
            {FILTER id=Delfador}
            facing=sw
            [filter_recall]
            [/filter_recall]
        [/modify_unit]
        
        {RECALL_XY Deoran 18 17}
        [modify_unit]
            {FILTER id=Deoran}
            facing=sw
            side=2
            [filter_recall]
            [/filter_recall]
        [/modify_unit]
        
        
        [unit]
            {SINGLEUNITWML_ELDRED_UNARMED}
            side,x,y,facing=2,20,10,nw
        [/unit]
        [unit]
            {SINGLEUNITWML_GARARD}
            side,x,y,facing=2,19,10,ne
            {MODIFICATIONS( [object]
                {EFFECT new_attack (
                    name,icon=_"punch",attacks/fist-human.png
                    range,type,damage,number=melee,impact,4,3
                )}
                {EFFECT new_animation ([attack_anim]
                    {FILTER_ATTACK name=punch}
                    start_time=-200
                    {FRAME image="units/garard/garard.png:200"}
                    {SOUND:HIT_AND_MISS fist.ogg fist.ogg -50}
                    {FRAME image="units/garard/garard.png:200"}
                [/attack_anim])}
            [/object] )}
        [/unit]
        {RESTORE_GARARD}
        [unit]
            {SINGLEUNITWML_ASHEVIERE}
            side,x,y,facing=2,28,7,sw
        [/unit]
    [/event]
    
    
    
    
    #######################################################################################################################################################
    #                                                                   PLAY SCENARIO
    #######################################################################################################################################################
    [event]
        name=start
        
        #############################
        # THREE CHEERS
        #############################
        {DELAY 500}
        [message]
            speaker=Deoran
            message=_"Three cheers for Delfador, hero of the Abez!"
        [/message]
        [message]
            speaker=Garard
            message=_"Three cheers— cheers for Delfador the Great! Hurrah!" # cheers for the King of Wesnoth
        [/message]
        
        {MODIFY_UNIT x,y=15,7 facing se} [message]
            x,y=15,7
            message=_"Hurrah for Delfador!"
        [/message]
        {MODIFY_UNIT x,y=15,7 facing nw}
        
        {MODIFY_UNIT x,y=10,8 facing se}
        [message]
            x,y=10,8
            message=_"Hooray for Delfador!"
        [/message]
        {MODIFY_UNIT x,y=10,8 facing nw}
        
        {MODIFY_UNIT x,y=15,12 facing ne}
        [message]
            x,y=15,12
            message=_"Hurrah for Del— *hic* Delfador!"
        [/message]
        {MODIFY_UNIT x,y=15,12 facing sw}
        
        [message]
            speaker=Delfador
            message=_"Ha ha ha, thank you all! That’s right, I’m Wesnoth’s hero! Your hero Delfador the Great, here in the flesh!"
        [/message]
        
        
        #############################
        # GARARD IS DRUNK
        #############################
        [message]
            speaker=Garard
            message=_"Oh ho, someone fetch me more wine! The night’s— night’s still youn— young... I’m ready for a proper CELEBRATION!!"
        [/message]
        [message]
            speaker=Eldred
            message=_"<span size='x-small'>Mother says you really shouldn’t drink so much—</span>"
        [/message]
        [harm_unit]
            {FILTER id=Eldred} {FILTER_SECOND id=Garard}
            [primary_attack]
                name=punch
            [/primary_attack]
            amount,animate,experience=1,yes,no
        [/harm_unit]
        [message]
            speaker=Garard
            message=_"Speak UP boy! I raised you; raised you to be a killer, not a cowardly— cowardly coward like you are."
        [/message]
        [message]
            speaker=Eldred
            message=_"(flushes) <span size='x-small'>You hardly raised me at all...</span>"
        [/message]
        [message]
            speaker=Garard
            message=_"Bah, who needs you anyways. Delfador is the hero tonight... Delfador is the hero, now Delfador the GREAT! “Great One,” ah ha, haha, ha ha ha he he..."
        [/message]
        [message]
            speaker=Delfador
            message=_"I started as an inglorious apprentice, without even a name to call my own. And now I’m one of the most famous mages in all Wesnoth! This is everything I ever dreamed of!!"
        [/message]
        [message]
            speaker=Delfador
            message=_"I’m giddy with joy... or maybe it’s also the wine too, heh."
        [/message]
        [message]
            speaker=Deoran
            message=_"My friend, you deserve it. Without most of their saurian allies Clan Blackcrest is on the run, and Clan Whitefang is falling back out of the eastern hills.

At long last lift the shadows of war; the realm is finally at peace. Perchance the coming days will bring laughter to the streets of Weldyn once again. We should—"
        [/message]
        
        
        #############################
        # DELFADOR USES THE LATRINES
        #############################
        [message]
            speaker=Delfador
            message=_"Wait a moment, hold that thought!"
        [/message]
        {MOVE_UNIT id=Delfador 26 5}
        [hide_unit]
            id=Delfador
        [/hide_unit]
        {FADE_MUSIC_OUT 1500}
        {REPLACE_SCENARIO_MUSIC silence.ogg}
        {SOUND toilet-flush.wav} # anachronistic, but easy to understand, and hopefully funny. And makes a good point to change the music
        {FADE_MUSIC_IN 100}
        {DELAY 3000}
        {MODIFY_UNIT id=Delfador facing sw}
        [unhide_unit]
            id=Delfador
        [/unhide_unit]
        {DELAY 1000}
        [message]
            speaker=Delfador
            message=_"Ugh... Alduin really needs to invent a spell for cleaning latrines. Maybe as high advisor I can finally get someone to research that."
        [/message]
        {MOVE_UNIT id=Delfador 26 6}
        {MOVE_UNIT id=Delfador 25 7}
        {DELAY 500}
        {MODIFY_UNIT id=Delfador facing se}
        {DELAY 500}
        
        
        #############################
        # DELFADOR MEETS ASHEVIERE
        #############################
        {REPLACE_SCENARIO_MUSIC underground.ogg}
        [message]
            speaker=Delfador
            message=_"Oh! Hello there, your majesty. I didn’t notice you earlier. Shouldn’t you be enjoying the celebration? It’s not every day that I— err, I mean your husband wins a war!"
        [/message]
        {DELAY 1500}
        [message]
            speaker=Delfador
            message=_"...you don’t look so good. Your skin is bruised in some places but ashen in others, and there are deep bags under your eyes. Stressed about the war, perhaps?"
        [/message]
        {DELAY 500}
        [message]
            speaker=Asheviere
            message=_"Hello Delfador.
I was not expecting to see you again."
        [/message]
        [message]
            speaker=Delfador
            message=_"Ah, I think I understand! Never fear, it takes more than a few orcs and saurians to bring down the hero of Wesnoth — all in a day’s work for Delfador the Great! Next time someone needs killing, you’ll know who to call!"
        [/message]
        {DELAY 500}
        [message]
            speaker=Asheviere
            message=_"Yes.
I will."
        [/message]
        {DELAY 1500}
        [message]
            speaker=Delfador
            message=_"...umm, yeah. Well, I should be going—"
        [/message]
        
        {MOVE_UNIT id=Garard 27 8}
        [message]
            speaker=Garard
            message=_"What’re you doing to my wizard? Always getting in my way, talking, always scheming."
        [/message]
        [message]
            speaker=Garard
            message=_"What, victory isn’t good enough for you? Never good enough... Go back to your tent and don’t spoil my warriors’ triumph with your sour face. WENCH!!"
        [/message]
        [harm_unit]
            {FILTER id=Asheviere} {FILTER_SECOND id=Garard}
            [primary_attack]
                name=punch
            [/primary_attack]
            amount,animate,experience=1,yes,no
        [/harm_unit]

        [harm_unit]
            {FILTER id=Asheviere} {FILTER_SECOND id=Garard}
            [primary_attack]
                name=punch
            [/primary_attack]
            amount,animate,experience=1,yes,no
        [/harm_unit]
        {MOVE_UNIT id=Asheviere 36 8}
        {KILL id=Asheviere}
        
        
        #############################
        # GARARD RAMBLES
        #############################
        [message]
            speaker=Garard
            message=_"Lousy— lousy woman. Dunno why— can’t marry— I can’t even marry a proper queen. What kind of king am I, Delfador? You’re high advice— advis— advisor, I need your— *hic* advice."
        [/message]
        [message]
            speaker=Delfador
            message=_"Did you just—? But Asheviere—?   ...uhh, I’m not sure I understand what you mean."
        [/message]
        {MODIFY_UNIT id=Garard facing nw}
        [message]
            speaker=Garard
            message=_"GREAT MEN, Delfador! My father— father was a great man, Delfador. Great man, great man and <i>his</i> father— and his fathers also great, great all the way back to Haldric I. King Haldric led our people— led our people to the entire realm of Wesnoth, the entire— entire race of men!"
        [/message]
        [message]
            speaker=Garard
            message=_"Now you’re one of them too! Delfador the Great... and what have I done? Nearly lost a war? Needed some— some wizard’s parlor trick to finish things? Can’t even control my imbecile of a wife... Who could respect a weakling, respect a weak king..."
        [/message]
        {DELAY 500}
        [message]
            speaker=Garard
            message=_"I don’t know Delfador, I don’t know; just, I don’t know. Listening to the men cheer for you... Do the people even— do they even love me any more? ...did they ever?"
        [/message]
        {DELAY 2000}
        [message]
            speaker=Delfador
            message=_"Well... uh, I..."
        [/message]
        
        
        #############################
        # KESTERL ARRIVES
        #############################
        [unit]
            {SINGLEUNITWML_KESTREL}
            side,x,y,facing=2,44,11,nw
            hitpoints=17
        [/unit]
        {MOVE_UNIT id=Kestrel 41 10}
        [harm_unit]
            {FILTER id=Kestrel}
            amount,animate=4,yes
        [/harm_unit]
        {PLACE_IMAGE scenery/blood-1.png 41 10}
        {DELAY 500}
        {MOVE_UNIT id=Kestrel 38 9}
        [message]
            speaker=Delfador
            message=_"<span size='x-small'>Whew, good timing for a distraction.</span>"
        [/message]
        [message]
            speaker=Kestrel
            message=_"Urgent message for Prince Eldred! Where is the crown prince?"
        [/message]
        {MOVE_UNIT id=Kestrel 33 11}
        {MOVE_UNIT id=Eldred 32 11}
        [message]
            speaker=Kestrel
            message=_"<i><span size='x-small'>whisper whisper whisper</span></i>"
        [/message]
        [message]
            speaker=Eldred
            message=_"<i><span size='x-small'>whisper whisper whisper</span></i>"
        [/message]
        {MOVE_UNIT id=Garard 31 11}
        [harm_unit]
            {FILTER id=Eldred} {FILTER_SECOND id=Garard}
            [primary_attack]
                name=punch
            [/primary_attack]
            amount,animate,experience=1,yes,no
        [/harm_unit]
        [message]
            speaker=Garard
            message=_"Get away, boy! Courier, I don't give a damn— damn about Eldred. Drunk or not, I’m still the king, still— still the KING! What’s your message?"
        [/message]
        {MOVE_UNIT id=Eldred 33 12}
        {MOVE_UNIT id=Eldred 34 11}
        {MODIFY_UNIT id=Eldred facing nw}
        
        
        #############################
        # NEWS OF THE BETRAYAL
        #############################
        [message]
            speaker=Eldred
            message=_"<span size='x-small'>It’s about your—</span>     ...father, it’s about your brother. Prince Arand."
        [/message]
        [message]
            speaker=Kestrel
            message=_"The madman’s declared his claim to the throne, and siezed control of Fort Garard! My men and I tried to stop him, but Arand’s guards bought enough time for him to escape into the fort. I myself barely made it away!"
        [/message]
        {FADE_MUSIC_OUT 3000}
        [message]
            speaker=Kestrel
            message=_"Sir—?"
        [/message]
        {REPLACE_SCENARIO_MUSIC silence.ogg}
        [message]
            speaker=Garard
            message=_"WHAT DID YOU SAY!?"
        [/message]
        {FADE_MUSIC_IN 1500}
        {REPLACE_SCENARIO_MUSIC frantic.ogg}
        [message]
            speaker=Garard
            message=_"That TREASONOUS son-of-a, son-of— I knew— knew he was acting dodgy lately. Wouldn’t speak to the queen, wouldn’t tell me and Eldred his moveme— movements. I want his head. I want— *hic* I want his HEAD!! DELFADOR!!"
        [/message]
        {MOVE_UNIT id=Deoran 26 10}
        [message]
            speaker=Deoran
            message=_"My lord, you’re drunk. At least wait until tomorrow before—"
        [/message]
        {MODIFY_UNIT id=Garard facing nw}
        [message]
            speaker=Garard
            message=_"SHUT UP!! Delfador! High advisor! Take my cavy— caval— cav— ...my horsemen. Ride to Fort Garard and burn it to— *hic* to the ground, TO THE GROUND!!"
        [/message]
        [message]
            speaker=Garard
            message=_"I want every one of those traitors dead! And return with Arand’s head, his HEAD— *hic*, or don’t return at all. DO YOU HEAR ME!?"
        [/message]
        {DELAY 500}
        {MODIFY_UNIT id=Deoran facing sw}
        [message]
            speaker=Deoran
            message=_"Delfador, the king won’t listen to me, but you can change his mind. You know this is wrong — we don’t yet have the full story."
        [/message]
        [message]
            speaker=Garard
            message=_"SILENCE!! I warn you, elf-dog, one more— one more word out of your mouth and you’ll meet the same fate as my— *hic* brother— <span size='small'>no brother, no he’s not my brother any more... *hic* why would he do this?</span> <span size='x-small'>Not my brother any more...</span>"
        [/message]
        {MOVE_UNIT id=Garard 31 12}
        {DELAY 1000}
        {MOVE_UNIT id=Garard 31 13}
        
        {DELAY 1500}
        {MOVE_UNIT id=Delfador 30 8}
        {MODIFY_UNIT id=Deoran facing se}
        {DELAY 500}
        {MOVE_UNIT id=Delfador 29 9}
        {DELAY 1500}
        [message]
            speaker=Delfador
            message=_"..."
        [/message]
        {DELAY 1500}
        {MODIFY_UNIT id=Delfador facing se}
        {DELAY 1000}
        {MODIFY_UNIT id=Delfador facing sw}
        {DELAY 1000}
        {MODIFY_UNIT id=Delfador facing se}
        {DELAY 1000}
        [message]
            speaker=Delfador
            message=_"M’lord... maybe Deoran is right. Maybe it’s best to wait—"
        [/message]
        [message]
            speaker=Eldred
            message=_"<span size='x-small'>Did you hear that? Delfador is refusing the king’s order!</span>"
        [/message]
        {MODIFY_UNIT id=Kestrel facing se}
        [message]
            speaker=Kestrel
            message=_"<span size='x-small'>I thought Delfador was supposed to be a great hero, no? The whole army’s singing his praises!</span>"
        [/message]
        [message]
            speaker=Eldred
            message=_"<span size='x-small'>All lies, by the sound of it. He’s just another posturing pretender, tsk tsk.</span>"
        [/message]
        [message]
            speaker=Eldred
            message=_"<span size='x-small'>From what mother tells me, this is exactly how Deoran got himself exiled, so many years ago.</span>"
        [/message]
        
        [message]
            speaker=Delfador
            message=_"All right, all right, I get it! Deoran I’m sorry, but... fire and destruction is what I do. I didn’t even have a name before I first began to battle!"
        [/message]
        {MODIFY_UNIT id=Delfador facing sw}
        [message]
            speaker=Delfador
            message=_"I’ve lived half my life fighting alongside the king, fighting to earn myself a place in history. Without that, who am I?"
        [/message]
        {DELAY 1500}
        [message]
            speaker=Delfador
            message=_"I don’t want to be remembered as a disgrace, like you..."
        [/message]
        [message]
            speaker=Deoran
            message=_"Delfador—"
        [/message]
        [message]
            speaker=Delfador
            message=_"Royal cavalry, form up on me; we ride with all haste to Fort Garard! Together we fight, fight for the king! Fight for Wesnoth!!"
        [/message]
        
        
        #############################
        # CLEANUP
        #############################
        {MODIFY_UNIT id=Deoran side 1}
        [store_unit]
            {FILTER id=Deoran}
            variable,kill=stored_deoran,yes
        [/store_unit]
        
        {MODIFY_UNIT id=$companion_id side 1}
        {MODIFY_UNIT x,y=14,7         side 1}
        [store_unit]
            {FILTER( side=1 {NOT id=Delfador,familiar} )}
            variable,kill=stored_units_s10x,yes
        [/store_unit]
        
        [endlevel]
            result=victory
            {NEW_GOLD_CARRYOVER 100}
            carryover_report,linger_mode,replay_save=no,no,no
        [/endlevel]
    [/event]
[/scenario]




